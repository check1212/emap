(()=>{var t={166:function(t){t.exports=function(){"use strict";function t(i,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,h=n-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*c*(a-c)/a)*(h-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-h*c/a+l)),Math.min(o,Math.floor(n+(a-h)*c/a+l)),s)}var p=i[n],f=r,d=o;for(e(i,r,n),s(i[o],p)>0&&e(i,r,o);f<d;){for(e(i,f,d),f++,d--;s(i[f],p)<0;)f++;for(;s(i[d],p)>0;)d--}0===s(i[r],p)?e(i,r,d):e(i,++d,o),d<=n&&(r=d+1),n<=d&&(o=d-1)}}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}return function(e,n,r,o,s){t(e,n,r||0,o||e.length-1,s||i)}}()},510:(t,e,i)=>{"use strict";t.exports=r,t.exports.default=r;var n=i(166);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,n,r){r||(r=_(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<i;s++)o=t.children[s],h(r,t.leaf?n(o):o);return r}function h(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function _(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,e,i,r,o){for(var s,a=[e,i];a.length;)(i=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((i-e)/r/2)*r,n(t,s,e,i,o),a.push(e,s,s,i))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!d(t,e))return i;for(var r,o,s,a,h=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],d(t,a=e.leaf?n(s):s)&&(e.leaf?i.push(s):f(t,a)?this._all(s,i):h.push(s));e=h.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!d(t,e))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],d(t,s=e.leaf?i(o):o)){if(e.leaf||f(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=_([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,s,a=this.data,h=this.toBBox(t),u=[],c=[];a||u.length;){if(a||(a=u.pop(),n=u[u.length-1],i=c.pop(),s=!0),a.leaf&&-1!==(r=o(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;s||a.leaf||!f(a,h)?n?(i++,a=n.children[i],s=!1):a=null:(u.push(a),c.push(i),i=0,n=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=_(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=_([])).leaf=!1,r.height=n;var h,u,c,l,p=Math.ceil(o/a),f=p*Math.ceil(Math.sqrt(a));for(g(t,e,i,f,this.compareMinX),h=e;h<=i;h+=f)for(g(t,h,c=Math.min(h+f-1,i),p,this.compareMinY),u=h;u<=c;u+=p)l=Math.min(u+p-1,c),r.children.push(this._build(t,u,l,n-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,h,u,c,p,f,d;n.push(e),!e.leaf&&n.length-1!==i;){for(c=p=1/0,r=0,o=e.children.length;r<o;r++)h=l(s=e.children[r]),f=t,d=s,(u=(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-h)<p?(p=u,c=h<c?h:c,a=s):u===p&&h<c&&(c=h,a=s);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),h(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=_(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data=_([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,s,h,u,c,p,f,d,_,g,y,m;for(u=c=1/0,n=e;n<=i-e;n++)f=r=a(t,0,n,this.toBBox),d=o=a(t,n,i,this.toBBox),void 0,void 0,void 0,void 0,_=Math.max(f.minX,d.minX),g=Math.max(f.minY,d.minY),y=Math.min(f.maxX,d.maxX),m=Math.min(f.maxY,d.maxY),s=Math.max(0,y-_)*Math.max(0,m-g),h=l(r)+l(o),s<u?(u=s,p=n,c=h<c?h:c):s===u&&h<c&&(c=h,p=n);return p},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,s=this.toBBox,u=a(t,0,e,s),c=a(t,i-e,i,s),l=p(u)+p(c);for(r=e;r<i-e;r++)o=t.children[r],h(u,t.leaf?s(o):o),l+=p(u);for(r=i-e-1;r>=e;r--)o=t.children[r],h(c,t.leaf?s(o):o),l+=p(c);return l},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)h(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():s(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";function t(t,e,i){return Math.min(Math.max(t,e),i)}var e="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};var n={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},r={};r[n.DEGREES]=2*Math.PI*6370997/360,r[n.FEET]=.3048,r[n.METERS]=1,r[n.USFEET]=1200/3937;const o=n;var s=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};s.prototype.canWrapX=function(){return this.canWrapX_},s.prototype.getCode=function(){return this.code_},s.prototype.getExtent=function(){return this.extent_},s.prototype.getUnits=function(){return this.units_},s.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||r[this.units_]},s.prototype.getWorldExtent=function(){return this.worldExtent_},s.prototype.getAxisOrientation=function(){return this.axisOrientation_},s.prototype.isGlobal=function(){return this.global_},s.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},s.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},s.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},s.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},s.prototype.setWorldExtent=function(t){this.worldExtent_=t},s.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},s.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};const a=s;var h=6378137,u=Math.PI*h,c=[-u,-u,u,u],l=[-180,-85,180,85],p=function(t){function i(i){t.call(this,{code:i,units:o.METERS,extent:c,global:!0,worldExtent:l,getPointResolution:function(t,i){return t/e(i[1]/h)}})}return t&&(i.__proto__=t),i.prototype=Object.create(t&&t.prototype),i.prototype.constructor=i,i}(a),f=[new p("EPSG:3857"),new p("EPSG:102100"),new p("EPSG:102113"),new p("EPSG:900913"),new p("urn:ogc:def:crs:EPSG:6.18:3:3857"),new p("urn:ogc:def:crs:EPSG::3857"),new p("http://www.opengis.net/gml/srs/epsg.xml#3857")];var d,_,g,y=[-180,-90,180,90],m=6378137*Math.PI/180,v=function(t){function e(e,i){t.call(this,{code:e,units:o.DEGREES,extent:y,axisOrientation:i,global:!0,metersPerUnit:m,worldExtent:y})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(a),x=[new v("CRS:84"),new v("EPSG:4326","neu"),new v("urn:ogc:def:crs:EPSG::4326","neu"),new v("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new v("urn:ogc:def:crs:OGC:1.3:CRS84"),new v("urn:ogc:def:crs:OGC:2:84"),new v("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new v("urn:x-ogc:def:crs:EPSG:4326","neu")],E={},w={};function S(t,e,i){var n=t.getCode(),r=e.getCode();n in w||(w[n]={}),w[n][r]=i}function I(t,e,i){var n;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];n=e}else n=t.slice();return n}function C(t,e,i){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function R(t){!function(t,e){E[t]=e}(t.getCode(),t),S(t,t,I)}function b(t){return"string"==typeof t?E[t]||null:t||null}function M(t){!function(t){t.forEach(R)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&S(e,t,I)}))}))}function F(t,e){return i=b(t),n=b(e),r=i.getCode(),o=n.getCode(),r in w&&o in w[r]&&(s=w[r][o]),(a=s)||(a=C),a;var i,n,r,o,s,a}function O(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function A(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function L(t){return A(1/0,1/0,-1/0,-1/0,t)}function T(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function D(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function k(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function P(t){return t[3]-t[1]}function X(t){return[t[2]-t[0],t[3]-t[1]]}function G(t,e){console.assert(Number.isInteger(t)&&t>=0);const i=t%e,n=(t-i)/e;return console.assert(Number.isInteger(n)&&n>=0),[i,n]}function B(t,e,i,n){const r=n[0]/e,o=n[1]/i;return[t[0]+(t[2]-t[0])*r,t[1]+(t[3]-t[1])*o]}function z(t,e,i){const[n,r]=e;if(e[0]>=t)throw new Error("Out of bound");if(e[1]*t+e[0]>=i.length)throw new Error("Out of buffer bound");const o=Math.floor(n),s=Math.floor(r),a=Math.ceil(n),h=Math.ceil(r),u=n-o,c=r-s,l=i[a+t*s],p=i[o+t*s],f=i[o+t*h];return(l-p)*u+(f-p)*c+(p+i[a+t*h]-l-f)*u*c+p}M(f),M(x),d=f,_=function(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=u,a=0;a<n;a+=r){o[a]=s*t[a]/180;var c=h*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));c>s?c=s:c<-s&&(c=-s),o[a+1]=c}return o},g=function(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=0;s<n;s+=r)o[s]=180*t[s]/u,o[s+1]=360*Math.atan(Math.exp(t[s+1]/h))/Math.PI-90;return o},x.forEach((function(t){d.forEach((function(e){S(t,e,_),S(e,t,g)}))}));class Y{constructor(t,e,i,n,r){if(t.length!=i*n)throw new Error(`Us size ${t.length} is not consistent with data dimensions: ${i}x${n}`);if(e.length!=i*n)throw new Error(`Vs size ${e.length} is not consistent with data dimensions: ${i}x${n}`);this.extent=function(t,e){return t.slice()}(r),this.dataWidth_=i,this.dataHeight_=n,this.speedBuffer_=new Float32Array(t.length),this.simpleSpeedBuffer=new Uint8Array(t.length),this.rotationBuffer_=new Float32Array(t.length),this.uBuffer_=t,this.vBuffer_=e,this.density=[i/(r[2]-r[0]),n/(r[3]-r[1])];for(let i=0;i<t.length;++i){const n=t[i],r=e[i],o=Math.sqrt(n*n+r*r),s=Math.atan2(r,n);this.speedBuffer_[i]=o,this.simpleSpeedBuffer[i]=Math.ceil(o),this.rotationBuffer_[i]=s}console.log(`Size: ${this.dataWidth_}x${this.dataHeight_} = ${this.uBuffer_.length}`)}getUVSpeed(t){const e=this.dataWidth_,i=this.dataHeight_,n=function(t,e,i,n){return[(n[0]-t[0])/(t[2]-t[0])*(e-1),(n[1]-t[1])/(t[3]-t[1])*(i-1)]}(this.extent,e,i,t);return[z(e,n,this.uBuffer_),z(e,n,this.vBuffer_)]}getRotation(t){return this.rotationBuffer_[t]}getSpeed(t){return this.speedBuffer_[t]}saveU(){const t=document.createElement("a");t.style.display="none",document.body.appendChild(t);const e=new Blob([this.uBuffer_],{type:"application/octet-stream"}),i=URL.createObjectURL(e);t.href=i,t.href=URL.createObjectURL(e),t.download="u.binary",t.click()}}var U="function"==typeof Object.assign?Object.assign:function(t,e){var i=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,o=arguments.length;r<o;++r){var s=i[r];if(null!=s)for(var a in s)s.hasOwnProperty(a)&&(n[a]=s[a])}return n};function W(t){for(var e in t)delete t[e]}function j(t){var e;for(e in t)return!1;return!e}function N(t,e,i,n){for(var r,o=0,s=t.length;o<s;++o)if((r=t[o]).listener===e&&r.bindTo===i)return n&&(r.deleteIndex=o),r}function K(t,e){var i=V(t);return i?i[e]:void 0}function V(t,e){var i=t.ol_lm;return!i&&e&&(i=t.ol_lm={}),i}function H(t,e){var i=K(t,e);if(i){for(var n=0,r=i.length;n<r;++n)t.removeEventListener(e,i[n].boundListener),W(i[n]);i.length=0;var o=V(t);o&&(delete o[e],0===Object.keys(o).length&&function(t){delete t.ol_lm}(t))}}function q(t,e,i,n,r){var o=V(t,!0),s=o[e];s||(s=o[e]=[]);var a=N(s,i,n,!1);return a?r||(a.callOnce=!1):(a={bindTo:n,callOnce:!!r,listener:i,target:t,type:e},t.addEventListener(e,function(t){var e=function(e){var i=t.listener,n=t.bindTo||t.target;return t.callOnce&&$(t),i.call(n,e)};return t.boundListener=e,e}(a)),s.push(a)),a}function J(t,e,i,n){return q(t,e,i,n,!0)}function Z(t,e,i,n){var r=K(t,e);if(r){var o=N(r,i,n,!0);o&&$(o)}}function $(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=K(t.target,t.type);if(e){var i="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==i&&e.splice(i,1),0===e.length&&H(t.target,t.type)}W(t)}}const Q="change";function tt(){return function(){throw new Error("Unimplemented abstract method.")}()}var et=0;function it(t){return t.ol_uid||(t.ol_uid=String(++et))}const nt="propertychange";var rt=function(){this.disposed_=!1};rt.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},rt.prototype.disposeInternal=function(){};const ot=rt;function st(){return!0}function at(){}var ht=function(t){this.propagationStopped,this.type=t,this.target=null};ht.prototype.preventDefault=function(){this.propagationStopped=!0},ht.prototype.stopPropagation=function(){this.propagationStopped=!0};const ut=ht;var ct=function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addEventListener=function(t,e){var i=this.listeners_[t];i||(i=this.listeners_[t]=[]),-1===i.indexOf(e)&&i.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new ut(t):t,i=e.type;e.target=this;var n,r=this.listeners_[i];if(r){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var o=0,s=r.length;o<s;++o)if(!1===r[o].call(this,e)||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var a=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];a--;)this.removeEventListener(i,at);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){!function(t){var e=V(t);if(e)for(var i in e)H(t,i)}(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);t in this.pendingRemovals_?(i[n]=at,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t])}},e}(ot);const lt=ct,pt=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent(Q)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=q(this,t[r],e);return n}return q(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=J(this,t[r],e);return n}return J(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)Z(this,t[i],e);else Z(this,t,e)},e}(lt);var ft=function(t){function e(e,i,n){t.call(this,e),this.key=i,this.oldValue=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ut),dt={};function _t(t){return dt.hasOwnProperty(t)?dt[t]:dt[t]="change:"+t}const gt=function(t){function e(e){t.call(this),it(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return U({},this.values_)},e.prototype.notify=function(t,e){var i;i=_t(t),this.dispatchEvent(new ft(i,t,e)),i=nt,this.dispatchEvent(new ft(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(pt),yt="opacity",mt="visible",vt="extent",xt="zIndex",Et="maxResolution",wt="minResolution",St="source";var It=function(e){function i(t){e.call(this);var i=U({},t);i[yt]=void 0!==t.opacity?t.opacity:1,i[mt]=void 0===t.visible||t.visible,i[xt]=t.zIndex,i[Et]=void 0!==t.maxResolution?t.maxResolution:1/0,i[wt]=void 0!==t.minResolution?t.minResolution:0,this.setProperties(i),this.state_=null,this.type}return e&&(i.__proto__=e),i.prototype=Object.create(e&&e.prototype),i.prototype.constructor=i,i.prototype.getType=function(){return this.type},i.prototype.getLayerState=function(){var e=this.state_||{layer:this,managed:!0};return e.opacity=t(this.getOpacity(),0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=this.getZIndex()||0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),this.state_=e,e},i.prototype.getLayersArray=function(t){return tt()},i.prototype.getLayerStatesArray=function(t){return tt()},i.prototype.getExtent=function(){return this.get(vt)},i.prototype.getMaxResolution=function(){return this.get(Et)},i.prototype.getMinResolution=function(){return this.get(wt)},i.prototype.getOpacity=function(){return this.get(yt)},i.prototype.getSourceState=function(){return tt()},i.prototype.getVisible=function(){return this.get(mt)},i.prototype.getZIndex=function(){return this.get(xt)},i.prototype.setExtent=function(t){this.set(vt,t)},i.prototype.setMaxResolution=function(t){this.set(Et,t)},i.prototype.setMinResolution=function(t){this.set(wt,t)},i.prototype.setOpacity=function(t){this.set(yt,t)},i.prototype.setVisible=function(t){this.set(mt,t)},i.prototype.setZIndex=function(t){this.set(xt,t)},i}(gt);const Ct="ready";var Rt=function(t){function e(e){var i=U({},e);delete i.source,t.call(this,i),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),q(this,_t(St),this.handleSourcePropertyChange_,this);var n=e.source?e.source:null;this.setSource(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(St)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():"undefined"},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&($(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=q(t,Q,this.handleSourceChange_,this)),this.changed()},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&($(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&($(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=q(t,"precompose",(function(t){var e=t,i=this.getLayerState();i.managed=!1,void 0===this.getZIndex()&&(i.zIndex=1/0),e.frameState.layerStatesArray.push(i),e.frameState.layerStates[it(this)]=i}),this),this.mapRenderKey_=q(this,Q,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(St,t)},e}(It);const bt=Rt;var Mt=new Array(6);function Ft(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],h=e[0],u=e[1],c=e[2],l=e[3],p=e[4],f=e[5];return t[0]=i*h+r*u,t[1]=n*h+o*u,t[2]=i*c+r*l,t[3]=n*c+o*l,t[4]=i*p+r*f+s,t[5]=n*p+o*f+a,t}function Ot(t,e,i,n,r,o,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=o,t[5]=s,t}function At(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function Lt(t,e,i){return Ft(t,Ot(Mt,e,0,0,i,0,0))}function Tt(t,e,i){return Ft(t,Ot(Mt,1,0,0,1,e,i))}function Dt(t,e){const i=function(t){const e=k(t),i=X(t),n=Tt([1,0,0,1,0,0],-e[0],-e[1]);return Ft(Lt([1,0,0,1,0,0],2/i[0],2/i[1]),n)}(t),n=function(t){const e=k(t),i=X(t),n=Lt([1,0,0,1,0,0],i[0]/2,i[1]/2);return Ft(Tt([1,0,0,1,0,0],e[0],e[1]),n)}(e);return Ft(n,i)}function kt(t,e){let[i,n]=t.size;if(i*=t.pixelRatio,n*=t.pixelRatio,e.width!==i||e.height!==n)return e.width=i,e.height=n,!0}const Pt=[];class Xt extends pt{constructor(t){super(),this.layer=t,this.canvases_=[document.createElement("canvas"),document.createElement("canvas")],this.previousFrame_={canvasId:0,centerX:0,centerY:0,resolution:1/0}}static handles(t){return t instanceof Gt}static create(t,e){return new Xt(e)}prepareFrame(t){const e=this.layer,i=this.canvases_[this.previousFrame_.canvasId];let n=i;const r=kt(t,i);let o=this.previousFrame_.canvasId;const[s,a]=t.viewState.center,h=t.viewState.resolution;if(!r&&this.previousFrame_.resolution===h){Pt[0]=this.previousFrame_.centerX,Pt[1]=this.previousFrame_.centerY,At(t.coordinateToPixelTransform,Pt);const e=Pt[0]-t.size[0]/2,r=Pt[1]-t.size[1]/2;if(0!==e||0!==r){o=(o+1)%2,n=this.canvases_[o],kt(t,n);const s=n.getContext("2d");s.clearRect(0,0,n.width,n.height),s.drawImage(i,e,r)}}this.previousFrame_.canvasId=o,this.previousFrame_.centerX=s,this.previousFrame_.centerY=a,this.previousFrame_.resolution=h;const u=n.getContext("2d");return e.doRender_(t,u),t.animate=!0,!0}composeFrame(t,e,i){const n=this.canvases_[this.previousFrame_.canvasId],r=n.width,o=n.height;i.drawImage(n,0,0,r,o)}}class Gt extends bt{constructor(t){super({}),this.doRender_=t.renderFunction}getSourceState(){return"ready"}}function Bt(t,e){e[0]=Math.random()*function(t){return t[2]-t[0]}(t)+t[0],e[1]=Math.random()*P(t)+t[1]}class zt extends Gt{constructor(t){super({renderFunction:(t,e)=>this.render(t,e)}),this.fading=t.fading||.8,console.assert(t.ttl),this.ttl=t.ttl,console.assert(t.map),this.map=t.map,console.assert(t.uvBuffer),this.uvBuffer=t.uvBuffer,console.assert(t.particles),this.particles=new Array(t.particles);for(let e=0;e<t.particles;++e)this.particles[e]={ttl:Math.random()*this.ttl,coordinates:[]};this.pixel=[],this.viewportWithDataExtent=[1/0,1/0,-1/0,-1/0],this.map.getRenderer().registerLayerRenderers([Xt]),this.particleSize=1.5}render(t,e){const i=e.canvas;"dimgray"!=e.fillStyle&&(e.fillStyle="dimgray"),this.advanceParticles(t,e),e.globalAlpha=this.fading,e.globalCompositeOperation="destination-in",e.fillRect(0,0,i.width,i.height),e.globalAlpha=1,e.globalCompositeOperation="source-over"}advanceParticles(t,e){if(n=this.uvBuffer.extent,r=t.extent,o=this.viewportWithDataExtent,s=o||[1/0,1/0,-1/0,-1/0],function(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}(n,r)?(n[0]>r[0]?s[0]=n[0]:s[0]=r[0],n[1]>r[1]?s[1]=n[1]:s[1]=r[1],n[2]<r[2]?s[2]=n[2]:s[2]=r[2],n[3]<r[3]?s[3]=n[3]:s[3]=r[3]):L(s),(i=this.viewportWithDataExtent)[2]<i[0]||i[3]<i[1])return;var i,n,r,o,s;const a=this.pixel,h=t.viewState.resolution,u=t.pixelRatio;this.particles.forEach((i=>{var n;0!==i.coordinates.length&&O(this.viewportWithDataExtent,(n=i.coordinates)[0],n[1])||Bt(this.viewportWithDataExtent,i.coordinates),a[0]=i.coordinates[0],a[1]=i.coordinates[1],At(t.coordinateToPixelTransform,a),e.fillRect(a[0]*u,a[1]*u,this.particleSize*u,this.particleSize*u),--i.ttl,i.ttl<0&&(Bt(this.viewportWithDataExtent,i.coordinates),i.ttl=this.ttl);const[r,o]=this.uvBuffer.getUVSpeed(i.coordinates);i.coordinates[0]+=r*h,i.coordinates[1]+=o*h}))}}const Yt=function(t){function e(e){var i="Assertion failed. See https://openlayers.org/en/v"+"5.3.3".split("-")[0]+"/doc/errors/#"+e+" for details.";t.call(this,i),this.code=e,this.name="AssertionError",this.message=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);function Ut(t,e){if(!t)throw new Yt(e)}var Wt=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,jt=/^([a-z]*)$/i;function Nt(t){return"string"==typeof t?t:Ht(t)}var Kt=function(){var t={},e=0;return function(i){var n;if(t.hasOwnProperty(i))n=t[i];else{if(e>=1024){var r=0;for(var o in t)0==(3&r++)&&(delete t[o],--e)}n=function(t){var e,i,n,r,o;if(jt.exec(t)&&(t=function(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i}return""}(t)),Wt.exec(t)){var s,a=t.length-1;s=a<=4?1:2;var h=4===a||8===a;e=parseInt(t.substr(1+0*s,s),16),i=parseInt(t.substr(1+1*s,s),16),n=parseInt(t.substr(1+2*s,s),16),r=h?parseInt(t.substr(1+3*s,s),16):255,1==s&&(e=(e<<4)+e,i=(i<<4)+i,n=(n<<4)+n,h&&(r=(r<<4)+r)),o=[e,i,n,r/255]}else 0==t.indexOf("rgba(")?Vt(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),Vt(o)):Ut(!1,14);return o}(i),t[i]=n,++e}return n}}();function Vt(e){return e[0]=t(e[0]+.5|0,0,255),e[1]=t(e[1]+.5|0,0,255),e[2]=t(e[2]+.5|0,0,255),e[3]=t(e[3],0,1),e}function Ht(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}function qt(t){return Array.isArray(t)?Ht(t):t}function Jt(t,e){var i=document.createElement("canvas");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}var Zt="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",$t=(Zt.indexOf("firefox"),-1!==Zt.indexOf("safari")&&Zt.indexOf("chrom"),-1!==Zt.indexOf("webkit")&&Zt.indexOf("edge"),Zt.indexOf("macintosh"),window.devicePixelRatio,function(){var t=!1;try{t=!!document.createElement("canvas").getContext("2d").setLineDash}catch(t){}return t}());navigator,window,window,navigator.msPointerEnabled;!function(){var t,e={}}();var Qt=[0,0,0,1],te=[0,0,0,1],ee=(new(function(t){function e(e){t.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent("clear")},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t,e){for(var i=this.oldest_;i;)t.call(e,i.value_,i.key_,this),i=i.newer},e.prototype.get=function(t){var e=this.entries_[t];return Ut(void 0!==e,15),e===this.newest_||(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e),e.value_},e.prototype.remove=function(t){var e=this.entries_[t];return Ut(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){Ut(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},e}(lt)),{});var ie=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale};ie.prototype.clone=function(){return new ie({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},ie.prototype.getOpacity=function(){return this.opacity_},ie.prototype.getRotateWithView=function(){return this.rotateWithView_},ie.prototype.getRotation=function(){return this.rotation_},ie.prototype.getScale=function(){return this.scale_},ie.prototype.getSnapToPixel=function(){return!1},ie.prototype.getAnchor=function(){return tt()},ie.prototype.getImage=function(t){return tt()},ie.prototype.getHitDetectionImage=function(t){return tt()},ie.prototype.getImageState=function(){return tt()},ie.prototype.getImageSize=function(){return tt()},ie.prototype.getHitDetectionImageSize=function(){return tt()},ie.prototype.getOrigin=function(){return tt()},ie.prototype.getSize=function(){return tt()},ie.prototype.setOpacity=function(t){this.opacity_=t},ie.prototype.setRotateWithView=function(t){this.rotateWithView_=t},ie.prototype.setRotation=function(t){this.rotation_=t},ie.prototype.setScale=function(t){this.scale_=t},ie.prototype.setSnapToPixel=function(t){},ie.prototype.listenImageChange=function(t,e){return tt()},ie.prototype.load=function(){tt()},ie.prototype.unlistenImageChange=function(t,e){tt()};const ne=ie;var re=function(t){function e(e){var i=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:1,rotateWithView:i,rotation:void 0!==e.rotation?e.rotation:0,scale:1}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=void 0!==e.radius?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=e.atlasManager,this.render_(this.atlasManager_)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return 2},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t,e){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t,e){},e.prototype.render_=function(t){var e,i,n="",r="",o=0,s=null,a=0,h=0;this.stroke_&&(null===(i=this.stroke_.getColor())&&(i=te),i=qt(i),void 0===(h=this.stroke_.getWidth())&&(h=1),s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),$t||(s=null,a=0),void 0===(r=this.stroke_.getLineJoin())&&(r="round"),void 0===(n=this.stroke_.getLineCap())&&(n="round"),void 0===(o=this.stroke_.getMiterLimit())&&(o=10));var u=2*(this.radius_+h)+1,c={strokeStyle:i,strokeWidth:h,size:u,lineCap:n,lineDash:s,lineDashOffset:a,lineJoin:r,miterLimit:o};if(void 0===t){var l=Jt(u,u);this.canvas_=l.canvas,e=u=this.canvas_.width,this.draw_(c,l,0,0),this.createHitDetectionCanvas_(c)}else{u=Math.round(u);var p,f=!this.fill_;f&&(p=this.drawHitDetectionCanvas_.bind(this,c));var d=this.getChecksum(),_=t.add(d,u,u,this.draw_.bind(this,c),p);this.canvas_=_.image,this.origin_=[_.offsetX,_.offsetY],e=_.image.width,f?(this.hitDetectionCanvas_=_.hitImage,this.hitDetectionImageSize_=[_.hitImage.width,_.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[u/2,u/2],this.size_=[u,u],this.imageSize_=[e,e]},e.prototype.draw_=function(t,e,i,n){var r,o,s;e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(a*=2),r=0;r<=a;r++)o=2*r*Math.PI/a-Math.PI/2+this.angle_,s=r%2==0?this.radius_:h,e.lineTo(t.size/2+s*Math.cos(o),t.size/2+s*Math.sin(o))}if(this.fill_){var u=this.fill_.getColor();null===u&&(u=Qt),e.fillStyle=qt(u),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=Jt(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o,s,a,h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(r*=2),o=0;o<=r;o++)a=2*o*Math.PI/r-Math.PI/2+this.angle_,s=o%2==0?this.radius_:h,e.lineTo(t.size/2+s*Math.cos(a),t.size/2+s*Math.sin(a))}e.fillStyle=Nt(Qt),e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var i="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[i,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},e}(ne),oe=function(t){function e(e){var i=e||{};t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,atlasManager:i.atlasManager})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},e}(re);const se=oe;var ae=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};ae.prototype.clone=function(){var t=this.getColor();return new ae({color:Array.isArray(t)?t.slice():t||void 0})},ae.prototype.getColor=function(){return this.color_},ae.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},ae.prototype.getChecksum=function(){if(void 0===this.checksum_){var t=this.color_;t?Array.isArray(t)||"string"==typeof t?this.checksum_="f"+Nt(t):this.checksum_=it(this.color_):this.checksum_="f-"}return this.checksum_};const he=ae;var ue=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};ue.prototype.clone=function(){var t=this.getColor();return new ue({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},ue.prototype.getColor=function(){return this.color_},ue.prototype.getLineCap=function(){return this.lineCap_},ue.prototype.getLineDash=function(){return this.lineDash_},ue.prototype.getLineDashOffset=function(){return this.lineDashOffset_},ue.prototype.getLineJoin=function(){return this.lineJoin_},ue.prototype.getMiterLimit=function(){return this.miterLimit_},ue.prototype.getWidth=function(){return this.width_},ue.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},ue.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},ue.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},ue.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},ue.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},ue.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},ue.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},ue.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=it(this.color_):this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};const ce=ue;var le=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=de,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};le.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new le({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},le.prototype.getRenderer=function(){return this.renderer_},le.prototype.setRenderer=function(t){this.renderer_=t},le.prototype.getGeometry=function(){return this.geometry_},le.prototype.getGeometryFunction=function(){return this.geometryFunction_},le.prototype.getFill=function(){return this.fill_},le.prototype.setFill=function(t){this.fill_=t},le.prototype.getImage=function(){return this.image_},le.prototype.setImage=function(t){this.image_=t},le.prototype.getStroke=function(){return this.stroke_},le.prototype.setStroke=function(t){this.stroke_=t},le.prototype.getText=function(){return this.text_},le.prototype.setText=function(t){this.text_=t},le.prototype.getZIndex=function(){return this.zIndex_},le.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=de,this.geometry_=t},le.prototype.setZIndex=function(t){this.zIndex_=t};var pe=null;function fe(t,e){if(!pe){var i=new he({color:"rgba(255,255,255,0.4)"}),n=new ce({color:"#3399CC",width:1.25});pe=[new le({image:new se({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return pe}function de(t){return t.getGeometry()}const _e=le,ge="fraction";var ye=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function me(t,e,i){return e+":"+t+":"+(i?Nt(i):"null")}ye.prototype.clear=function(){this.cache_={},this.cacheSize_=0},ye.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},ye.prototype.get=function(t,e,i){var n=me(t,e,i);return n in this.cache_?this.cache_[n]:null},ye.prototype.set=function(t,e,i,n){var r=me(t,e,i);this.cache_[r]=n,++this.cacheSize_},ye.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()};var ve=new ye,xe=function(t){function e(e,i,n,r,o,s){t.call(this),this.hitDetectionImage_=null,this.image_=e||new Image,null!==r&&(this.image_.crossOrigin=r),this.canvas_=s?document.createElement("canvas"):null,this.color_=s,this.imageListenerKeys_=null,this.imageState_=o,this.size_=n,this.src_=i,this.tainted_}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isTainted_=function(){if(void 0===this.tainted_&&2===this.imageState_){this.tainted_=!1;var t=Jt(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch(t){this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(Q)},e.prototype.handleImageError_=function(){this.imageState_=3,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=2,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],i=this.size_[1],n=Jt(e,i);n.fillRect(0,0,e,i),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(0==this.imageState_){this.imageState_=1,this.imageListenerKeys_=[J(this.image_,"error",this.handleImageError_,this),J(this.image_,"load",this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(t){this.handleImageError_()}}},e.prototype.replaceColor_=function(){if(this.color_&&!this.isTainted_()){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var e=t.getImageData(0,0,this.image_.width,this.image_.height),i=e.data,n=this.color_[0]/255,r=this.color_[1]/255,o=this.color_[2]/255,s=0,a=i.length;s<a;s+=4)i[s]*=n,i[s+1]*=r,i[s+2]*=o;t.putImageData(e,0,0)}},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach($),this.imageListenerKeys_=null},e}(lt);const Ee="bottom-left",we="bottom-right",Se="top-left",Ie="top-right";var Ce=function(t){function e(e){var i=e||{},n=void 0!==i.opacity?i.opacity:1,r=void 0!==i.rotation?i.rotation:0,o=void 0!==i.scale?i.scale:1,s=void 0!==i.rotateWithView&&i.rotateWithView;t.call(this,{opacity:n,rotation:r,scale:o,rotateWithView:s}),this.anchor_=void 0!==i.anchor?i.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==i.anchorOrigin?i.anchorOrigin:Se,this.anchorXUnits_=void 0!==i.anchorXUnits?i.anchorXUnits:ge,this.anchorYUnits_=void 0!==i.anchorYUnits?i.anchorYUnits:ge,this.crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null;var a=void 0!==i.img?i.img:null,h=void 0!==i.imgSize?i.imgSize:null,u=i.src;Ut(!(void 0!==u&&a),4),Ut(!a||a&&h,5),void 0!==u&&0!==u.length||!a||(u=a.src||it(a)),Ut(void 0!==u&&u.length>0,6);var c,l=void 0!==i.src?0:2;this.color_=void 0!==i.color?(c=i.color,Array.isArray(c)?c:Kt(c)):null,this.iconImage_=function(t,e,i,n,r,o){var s=ve.get(e,n,o);return s||(s=new xe(t,e,i,n,r,o),ve.set(e,n,o,s)),s}(a,u,h,this.crossOrigin_,l,this.color_),this.offset_=void 0!==i.offset?i.offset:[0,0],this.offsetOrigin_=void 0!==i.offsetOrigin?i.offsetOrigin:Se,this.origin_=null,this.size_=void 0!==i.size?i.size:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==ge||this.anchorYUnits_==ge){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==ge&&(t[0]*=e[0]),this.anchorYUnits_==ge&&(t[1]*=e[1])}if(this.anchorOrigin_!=Se){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=Ie&&this.anchorOrigin_!=we||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=Ee&&this.anchorOrigin_!=we||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=Se){var e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),this.offsetOrigin_!=Ie&&this.offsetOrigin_!=we||(t[0]=i[0]-e[0]-t[0]),this.offsetOrigin_!=Ee&&this.offsetOrigin_!=we||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t,e){return q(this.iconImage_,Q,t,e)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t,e){Z(this.iconImage_,Q,t,e)},e}(ne);const Re=Ce;function be(t,e,i,n){const r=32*e,o=i.density,s=Math.max(o[0]*r,o[1]*r),{i:a,column:h,line:u}=t.getGeometry().getCoordinates()[2];if(h%Math.ceil(s)!=0||u%Math.ceil(s)!=0)return null;const c=i.getSpeed(a),l=i.getRotation(a),p=n(c);return p?(p.getImage().setRotation(-l),p):void 0}var Me="renderOrder",Fe=function(t){function e(e){var i=e||{},n=U({},i);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,t.call(this,n),this.declutter_=void 0!==i.declutter&&i.declutter,this.renderBuffer_=void 0!==i.renderBuffer?i.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(i.style),this.updateWhileAnimating_=void 0!==i.updateWhileAnimating&&i.updateWhileAnimating,this.updateWhileInteracting_=void 0!==i.updateWhileInteracting&&i.updateWhileInteracting,this.renderMode_=i.renderMode||"vector",this.type="VECTOR"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.setDeclutter=function(t){this.declutter_=t},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Me)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(Me,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:fe,this.styleFunction_=null===t?void 0:function(t){var e,i;"function"==typeof t?e=t:(Array.isArray(t)?i=t:(Ut("function"==typeof t.getZIndex,41),i=[t]),e=function(){return i});return e}(this.style_),this.changed()},e.prototype.getRenderMode=function(){return this.renderMode_},e}(bt);Fe.prototype.getSource;const Oe=Fe,Ae="add",Le="remove";var Te="length",De=function(t){function e(e,i){t.call(this,e),this.element=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ut),ke=function(t){function e(e,i){t.call(this);var n=i||{};if(this.unique_=!!n.unique,this.array_=e||[],this.unique_)for(var r=0,o=this.array_.length;r<o;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Te)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new De(Ae,e))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new De(Le,e)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new De(Le,n)),this.dispatchEvent(new De(Ae,e))}else{for(var r=i;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(Te,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new Yt(58)},e}(gt);const Pe=ke,Xe="arraybuffer",Ge="json",Be="text",ze="xml";function Ye(t,e){return[[-1/0,-1/0,1/0,1/0]]}var Ue=function(t){function e(e){t.call(this),this.projection_=b(e.projection),this.attributions_=We(e.attributions),this.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,this.loading=!1,this.state_=void 0!==e.state?e.state:Ct,this.wrapX_=void 0!==e.wrapX&&e.wrapX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return tt()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=We(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(gt);function We(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const je=Ue,Ne="addfeature",Ke="removefeature";var Ve=i(510),He=i.n(Ve),qe=function(t){this.rbush_=He()(t,void 0),this.items_={}};qe.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[it(e)]=i},qe.prototype.load=function(t,e){for(var i=new Array(e.length),n=0,r=e.length;n<r;n++){var o=t[n],s=e[n],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};i[n]=a,this.items_[it(s)]=a}this.rbush_.load(i)},qe.prototype.remove=function(t){var e=it(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},qe.prototype.update=function(t,e){var i=this.items_[it(e)];T([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))},qe.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},qe.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))},qe.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},qe.prototype.forEachInExtent=function(t,e,i){return this.forEach_(this.getInExtent(t),e,i)},qe.prototype.forEach_=function(t,e,i){for(var n,r=0,o=t.length;r<o;r++)if(n=e.call(i,t[r]))return n;return n},qe.prototype.isEmpty=function(){return j(this.items_)},qe.prototype.clear=function(){this.rbush_.clear(),this.items_={}},qe.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return A(e.minX,e.minY,e.maxX,e.maxY,t)},qe.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]};const Je=qe;var Ze=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ut),$e=function(t){function e(e){var i,n,r=e||{};t.call(this,{attributions:r.attributions,projection:void 0,state:Ct,wrapX:void 0===r.wrapX||r.wrapX}),this.loader_=at,this.format_=r.format,this.overlaps_=null==r.overlaps||r.overlaps,this.url_=r.url,void 0!==r.loader?this.loader_=r.loader:void 0!==this.url_&&(Ut(this.format_,7),this.loader_=(i=this.url_,n=this.format_,function(t,e,i,n){return function(r,o,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(r,o,s):t,!0),e.getType()==Xe&&(a.responseType="arraybuffer"),a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var r,o=e.getType();o==Ge||o==Be?r=a.responseText:o==ze?(r=a.responseXML)||(r=(new DOMParser).parseFromString(a.responseText,"application/xml")):o==Xe&&(r=a.response),r?i.call(this,e.readFeatures(r,{featureProjection:s}),e.readProjection(r),e.getLastExtent()):n.call(this)}else n.call(this)}.bind(this),a.onerror=function(){n.call(this)}.bind(this),a.send()}}(i,n,(function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)}),at))),this.strategy_=void 0!==r.strategy?r.strategy:Ye;var o,s,a=void 0===r.useSpatialIndex||r.useSpatialIndex;this.featuresRtree_=a?new Je:null,this.loadedExtentsRtree_=new Je,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(r.features)?s=r.features:r.features&&(s=(o=r.features).getArray()),a||void 0!==o||(o=new Pe(s)),void 0!==s&&this.addFeaturesInternal(s),void 0!==o&&this.bindFeaturesCollection_(o)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=it(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Ze(Ne,t))}},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[q(e,Q,this.handleFeatureChange_,this),q(e,nt,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n?n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e:(Ut(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],n=[],r=0,o=t.length;r<o;r++){var s=t[r],a=it(s);this.addToIndex_(a,s)&&i.push(s)}for(var h=0,u=i.length;h<u;h++){var c=i[h],l=it(c);this.setupChangeEvents_(l,c);var p=c.getGeometry();if(p){var f=p.getExtent();e.push(f),n.push(c)}else this.nullGeometryFeatures_[l]=c}this.featuresRtree_&&this.featuresRtree_.load(e,n);for(var d=0,_=i.length;d<_;d++)this.dispatchEvent(new Ze(Ne,i[d]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;q(this,Ne,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),q(this,Ke,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),q(t,Ae,(function(t){e||(e=!0,this.addFeature(t.element),e=!1)}),this),q(t,Le,(function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}),this),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_)this.featureChangeKeys_[e].forEach($);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal,this),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var n=new Ze("clear");this.dispatchEvent(n),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),j(this.nullGeometryFeatures_)||function(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,r=0;r<n;r++)t[t.length]=i[r]}(t,function(t){var e=[];for(var i in t)e.push(t[i]);return e}(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],r=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],h=e||st;return this.featuresRtree_.forEachInExtent(a,(function(t){if(h(t)){var e=t.getGeometry(),u=s;if((s=e.closestPointXY(i,n,o,s))<u){r=t;var c=Math.sqrt(s);a[0]=i-c,a[1]=n-c,a[2]=i+c,a[3]=n+c}}})),r},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=it(e),n=e.getGeometry();if(n){var r=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var o=e.getId();if(void 0!==o){var s=o.toString();i in this.undefIdIndex_?(delete this.undefIdIndex_[i],this.idIndex_[s]=e):this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else i in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[i]=e);this.changed(),this.dispatchEvent(new Ze("changefeature",e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:it(t)in this.undefIdIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&j(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,i){var n=this,r=this.loadedExtentsRtree_,o=this.strategy_(t,e);this.loading=!1;for(var s=function(t,s){var a=o[t];r.forEachInExtent(a,(function(t){return e=t.extent,i=a,e[0]<=i[0]&&i[2]<=e[2]&&e[1]<=i[1]&&i[3]<=e[3];var e,i}))||(n.loader_.call(n,a,e,i),r.insert(a,{extent:a.slice()}),n.loading=n.loader_!==at)},a=0,h=o.length;a<h;++a)s(a)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,(function(i){if(T(i.extent,t))return e=i,!0})),e&&i.remove(e)},e.prototype.removeFeature=function(t){var e=it(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=it(t);this.featureChangeKeys_[e].forEach($),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i?delete this.idIndex_[i.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new Ze(Ke,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e}(je);const Qe=$e;var ti=function(t){function e(e){if(t.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,q(this,_t(this.geometryName_),this.handleGeometryChanged_,this),e)if("function"==typeof e.getSimplifiedGeometry){var i=e;this.setGeometry(i)}else{var n=e;this.setProperties(n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&($(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=q(t,Q,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){var e,i;this.style_=t,this.styleFunction_=t?"function"==typeof(e=t)?e:(Array.isArray(e)?i=e:(Ut("function"==typeof e.getZIndex,41),i=[e]),function(){return i}):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){Z(this,_t(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=t,q(this,_t(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},e}(gt);const ei=ti;var ii=[1,0,0,1,0,0],ni=function(t){function e(){t.call(this),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return tt()},e.prototype.closestPointXY=function(t,e,i,n){return tt()},e.prototype.containsXY=function(t,e){return!1},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return tt()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){tt()},e.prototype.scale=function(t,e,i){tt()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return tt()},e.prototype.getType=function(){return tt()},e.prototype.applyTransform=function(t){tt()},e.prototype.intersectsExtent=function(t){return tt()},e.prototype.translate=function(t,e){tt()},e.prototype.transform=function(t,e){var i=b(t),n=i.getUnits()==o.TILE_PIXELS?function(t,n,r){var o,s,a,h,u,c,l,p=i.getExtent(),f=i.getWorldExtent(),d=P(f)/P(p);return o=ii,s=f[0],a=f[3],h=d,u=-d,c=Math.sin(0),l=Math.cos(0),o[0]=h*l,o[1]=u*c,o[2]=-h*c,o[3]=u*l,o[4]=0*h*l-0*h*c+s,o[5]=0*u*c+0*u*l+a,function(t,e,i,n,r,o){for(var s=o||[],a=0,h=0;h<i;h+=n){var u=t[h],c=t[h+1];s[a++]=r[0]*u+r[2]*c+r[4],s[a++]=r[1]*u+r[3]*c+r[5]}o&&s.length!=a&&(s.length=a)}(t,0,t.length,r,ii,n),F(i,e)(t,n,r)}:F(i,e);return this.applyTransform(n),this},e}(gt);const ri="XY",oi="XYZM";var si=function(t){function e(){t.call(this),this.layout=ri,this.stride=2,this.flatCoordinates=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeExtent=function(t){return e=this.flatCoordinates,i=0,n=this.flatCoordinates.length,r=this.stride,function(t,e,i,n,r){for(;i<n;i+=r)D(t,e[i],e[i+1]);return t}(L(t),e,i,n,r);var e,i,n,r},e.prototype.getCoordinates=function(){return tt()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(W(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=ai(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){tt()},e.prototype.setLayout=function(t,e,i){var n;if(t)n=ai(t);else{for(var r=0;r<i;++r){if(0===e.length)return this.layout=ri,void(this.stride=2);e=e[0]}t=function(t){var e;return 2==t?e=ri:3==t?e="XYZ":4==t&&(e=oi),e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,r,o,s){for(var a=s||[],h=Math.cos(r),u=Math.sin(r),c=o[0],l=o[1],p=0,f=0;f<i;f+=n){var d=t[f]-c,_=t[f+1]-l;a[p++]=c+d*h-_*u,a[p++]=l+d*u+_*h;for(var g=f+2;g<f+n;++g)a[p++]=t[g]}s&&a.length!=p&&(a.length=p)}(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var r=i;r||(r=k(this.getExtent()));var o=this.getFlatCoordinates();if(o){var s=this.getStride();!function(t,e,i,n,r,o,s,a){for(var h=a||[],u=s[0],c=s[1],l=0,p=0;p<i;p+=n){var f=t[p]-u,d=t[p+1]-c;h[l++]=u+r*f,h[l++]=c+o*d;for(var _=p+2;_<p+n;++_)h[l++]=t[_]}a&&h.length!=l&&(h.length=l)}(o,0,o.length,s,t,n,r,o),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,r,o,s){for(var a=s||[],h=0,u=0;u<i;u+=n){a[h++]=t[u]+r,a[h++]=t[u+1]+o;for(var c=u+2;c<u+n;++c)a[h++]=t[c]}s&&a.length!=h&&(a.length=h)}(i,0,i.length,n,t,e,i),this.changed()}},e}(ni);function ai(t){var e;return t==ri?e=2:"XYZ"==t||"XYM"==t?e=3:t==oi&&(e=4),e}var hi=function(t){function e(e,i){t.call(this),this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r,o,s,a,h,u,c=this.flatCoordinates,l=(r=t,o=e,s=c[0],a=c[1],(h=s-r)*h+(u=a-o)*u);if(l<n){for(var p=this.stride,f=0;f<p;++f)i[f]=c[f];return i.length=p,l}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return i=t,A(n=(e=this.flatCoordinates)[0],r=e[1],n,r,i);var e,i,n,r},e.prototype.getType=function(){return"Point"},e.prototype.intersectsExtent=function(t){return O(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,i,n){for(var r=0,o=i.length;r<o;++r)t[e++]=i[r];return e}(this.flatCoordinates,0,t,this.stride),this.changed()},e}(si);const ui=hi;class ci extends Oe{constructor(t){const e=t.uvBuffer,i=e.dataWidth_,n=e.dataHeight_,r=e.extent;let o=0;const s=[];for(let t=0;t<n;++t)for(let e=0;e<i;++e){const a=B(r,i,n,G(o,i));s.push(new ei(new ui([...a,{i:o,column:e,line:t}],"XYM"))),++o}const a="barbs"===t.style?function(t){const e=[];for(let t=0;t<26;++t){const i=new _e({image:new Re({rotateWithView:!0,src:"arrows/wind_"+t+".png"})});e[t]=i}function i(t){let i=t/1.852;return e[Math.ceil(i/5)]}return(e,n)=>be(e,n,t,i)}(e):function(t){const e={};function i(t){let i="black";return t<.2?null:(i=t<1?"blue":t<5?"green":"red",e[i])}return["red","green","black","blue"].forEach((t=>{const i=new _e({image:new Re({rotateWithView:!0,src:"white-arrow.png",color:t})});e[t]=i})),(e,n)=>be(e,n,t,i)}(e);super({opacity:t.opacity,updateWhileInteracting:!0,style:a,source:new Qe({features:s})})}}class li extends pt{constructor(t){super(),this.layer=t,this.canvas_=document.createElement("canvas"),this.canvas_.classList.add("custom-canvas")}static handles(t){return t instanceof pi}static create(t,e){return new li(e)}prepareFrame(t){const e=this.layer;kt(t,this.canvas_);const i=this.canvas_.getContext("webgl");return e.doRender_.call(e,t,i)}composeFrame(t,e,i){i.globalAlpha=this.layer.getOpacity()||1,i.drawImage(this.canvas_,0,0,this.canvas_.width,this.canvas_.height),i.globalAlpha=1}}class pi extends bt{constructor(t){super({opacity:t.opacity}),this.doRender_=t.renderFunction}getSourceState(){return"ready"}}function fi(t,e){const i=e.getSize();return function(t,e,i){const n=Dt([0,0,...t],e);return Ft(Dt(i,[0,0,1,1]),n)}(i,e.getView().calculateExtent(i),t.extent)}class di extends pi{constructor(t){super({opacity:t.opacity,renderFunction:(...t)=>this.reallyDoRender_(...t)}),this.uvBuffer=t.uvBuffer,this.uvBuffer||console.error("You must pass the uvbuffer in constructor"),this.map=t.map,this.map||console.error("You must pass the map in constructor"),this.map.getRenderer().registerLayerRenderers([li])}reallyDoRender_(t,e){return this.matrixLoc||this.createProgram_(e),this.draw(e),t.animate=!0,!0}createProgram_(t){if(!t.getExtension("OES_texture_float"))return void alert("this machine or browser does not support OES_texture_float");if(!t.getExtension("OES_texture_float_linear"))return void alert("this machine or browser does not support  OES_texture_float_linear");var e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,-1,1,1]),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null);var i=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,3]),t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null);var n=t.createShader(t.VERTEX_SHADER);t.shaderSource(n,"\n    attribute vec2 coordinates;\n    void main(void) {\n      gl_Position = vec4(coordinates, 0.0, 1.0);\n    }\n  "),t.compileShader(n);var r=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,"\n #ifdef GL_FRAGMENT_PRECISION_HIGH\n\tprecision highp float;\n  #else\n    precision mediump float;\n  #endif\n    uniform sampler2D texu;\n    uniform sampler2D texv;\n    uniform mat3 matrix;\n\n    vec3 colorA = vec3(0.0, 0.0, 1.0);\n    vec3 colorB = vec3(0.0, 1.0, 0.0);\n    vec3 colorC = vec3(1.0, 0.0, 0.0);\n\n    void main(void) {\n      mediump vec3 coord = matrix * vec3(gl_FragCoord.x, gl_FragCoord.y, 1);\n      mediump float speedu = texture2D(texu, coord.xy).x;\n      mediump float  speedv = texture2D(texv, coord.xy).y;\n      float speed = sqrt(speedu * speedu + speedv * speedv);\n      if (coord.x < 0.0 || coord.y < 0.0 || coord.x > 1.0 || coord.y > 1.0) {\n        discard;\n      }\n      vec3 color = colorC;\n      if (speed < 5.0) {\n        color = mix(colorA, colorB, speed / 5.0);\n      } else if (speed < 10.0) {\n        color = mix(colorB, colorC, (speed - 5.0) / 5.0);\n      }\n      gl_FragColor = vec4(color.rgb, 1.0);\n    }\n  "),t.compileShader(r);var o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,r),t.linkProgram(o),t.validateProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw"Could not compile WebGL program. \n\n"+t.getProgramInfoLog(o);t.useProgram(o),t.bindBuffer(t.ARRAY_BUFFER,e),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i);var s=t.getAttribLocation(o,"coordinates");t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(s),t.pixelStorei(t.UNPACK_ALIGNMENT,1),this.reloadTextures(t);const a=t.getUniformLocation(o,"texu");t.uniform1i(a,0);const h=t.getUniformLocation(o,"texv");t.uniform1i(h,1);const u=t.getUniformLocation(o,"matrix");this.matrixLoc=u}activateTexture(t,e,i){t.activeTexture(0===e?t.TEXTURE0:t.TEXTURE1);const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texParameterf(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameterf(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const r=t.LUMINANCE,o=i.dataWidth_,s=i.dataHeight_,a=t.LUMINANCE,h=t.FLOAT,u=0===e?i.uBuffer_:i.vBuffer_;t.texImage2D(t.TEXTURE_2D,0,r,o,s,0,a,h,u)}reloadTextures(t){this.activateTexture(t,0,this.uvBuffer),this.activateTexture(t,1,this.uvBuffer)}draw(t){const e=[(i=fi(this.uvBuffer,this.map))[0],i[1],0,i[2],i[3],0,i[4],i[5],1];var i;t.uniformMatrix3fv(this.matrixLoc,!1,e),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT);const n=t.canvas;t.viewport(0,0,n.width,n.height),t.drawElements(t.TRIANGLE_FAN,4,t.UNSIGNED_SHORT,0)}}Promise.all([fetch("./metadata.json").then((t=>t.json())),fetch("./u.bin").then((t=>t.arrayBuffer())),fetch("./v.bin").then((t=>t.arrayBuffer()))]).then((t=>{const[e,i,n]=t,{extent:r,width:o,height:s}=e,a=new Float32Array(i),h=new Float32Array(n),u=new Y(a,h,o,s,r);window.uv=u,windGradientLayer=new di({opacity:.25,map,uvBuffer:u});const c=document.location.search.includes("barbs")?"barbs":null;arrowLayer=new ci({uvBuffer:u,opacity:.5,style:c}),windParticlesLayer=new zt({map,uvBuffer:u,particles:1e4,fading:.95,ttl:50})}))})()})();
//# sourceMappingURL=bundle.js.map